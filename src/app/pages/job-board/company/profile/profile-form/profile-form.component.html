<app-skeleton [type]="'form'" *ngIf="!skeletonCompany"></app-skeleton>
<div class="p-fluid" *ngIf="skeletonCompany">
    <form [formGroup]="formCompanyIn" (ngSubmit)="onSubmit()">
        <div class="p-formgrid p-grid">
            <div class="p-field p-xl-2 p-lg-2 p-md-12 p-sm-12">
                <button pButton pRipple type="submit" label="Guardar" icon="pi pi-save"
                        class="p-button-raised"></button>
            </div>
        </div>
        <div class="p-formgrid p-grid">
            <div class="p-field p-xl-6 p-lg-6 p-md-12 p-sm-12">
                <div formGroupName="user">
                    <p-card header="Datos de Usuario:">
                        <div class="p-formgrid p-grid">
                            <div class="p-field p-xl-4 p-lg-4 p-md-12 p-sm-12">
                                <label for="names">
                                    <i class="p-error">*</i> Nombres:
                                    <i *ngIf="namesField.valid" class="pi pi-check-circle icon-valid"></i>
                                    <i *ngIf="namesField.invalid && (namesField.touched || namesField.dirty)"
                                       class="pi pi-times-circle icon-invalid"></i>
                                </label>
                                <input pInputText id="names" formControlName="names">
                                <div *ngIf="namesField.invalid && (namesField.touched || namesField.dirty)">
                                    <small *ngIf="namesField.errors?.required" id="names-help-1" class="p-error">
                                        {{messageService.fieldRequired}}
                                    </small>
                                </div>
                            </div>
                            <div class="p-field p-xl-4 p-lg-4 p-md-12 p-sm-12">
                                <label for="first_lastname">
                                    <i class="p-error">*</i> Primer Apellido:
                                    <i *ngIf="firstLastnameField.valid" class="pi pi-check-circle icon-valid"></i>
                                    <i *ngIf="firstLastnameField.invalid && (firstLastnameField.touched || firstLastnameField.dirty)"
                                       class="pi pi-times-circle icon-invalid"></i>
                                </label>
                                <input pInputText id="first_lastname" formControlName="first_lastname">
                                <div *ngIf="firstLastnameField.invalid && (firstLastnameField.touched || firstLastnameField.dirty)">
                                    <small *ngIf="firstLastnameField.errors?.required" id="first-lastname-help-1"
                                           class="p-error">
                                        {{messageService.fieldRequired}}
                                    </small>
                                </div>
                            </div>
                            <div class="p-field p-xl-4 p-lg-4 p-md-12 p-sm-12">
                                <label for="second_lastname">
                                    <i class="p-error">*</i> Segundo Apellido:
                                    <i *ngIf="secondLastnameField.valid" class="pi pi-check-circle icon-valid"></i>
                                    <i *ngIf="secondLastnameField.invalid && (secondLastnameField.touched || secondLastnameField.dirty)"
                                       class="pi pi-times-circle icon-invalid"></i>
                                </label>
                                <input pInputText id="second_lastname" formControlName="second_lastname">
                                <div *ngIf="secondLastnameField.invalid && (secondLastnameField.touched || secondLastnameField.dirty)">
                                    <small *ngIf="secondLastnameField.errors?.required" id="second-lastname-help-1"
                                           class="p-error">
                                        {{messageService.fieldRequired}}
                                    </small>
                                </div>
                            </div>

                        </div>
                        <div class="p-formgrid p-grid">
                            <div class="p-field p-xl-6 p-lg-6 p-md-6 p-sm-12">
                                <label for="identification_type">
                                    <i class="p-error">*</i> Tipo de documento:
                                    <i *ngIf="identificationField.valid" class="pi pi-check-circle icon-valid"></i>
                                    <i *ngIf="identificationField.invalid && (identificationField.touched || identificationField.dirty)"
                                       class="pi pi-times-circle icon-invalid"></i>
                                </label>
                                <p-dropdown id="identification_type" [options]="identificationTypes"
                                            formControlName="identification_type"
                                            (onClick)="validateIdentificationType()"
                                            optionLabel="name"
                                            [filter]="true" filterBy="name"
                                            placeholder="Seleccione...">
                                    <ng-template pTemplate="selectedItem">
                                        <div class="country-item country-item-value"
                                             *ngIf="identificationTypeField.value">
                                            <div>{{identificationTypeField.value.name}}</div>
                                        </div>
                                    </ng-template>
                                    <ng-template let-item pTemplate="item">
                                        <div class="country-item">
                                            <div>{{item.name}}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                                <div *ngIf="identificationTypeField.invalid && (identificationTypeField.touched || identificationTypeField.dirty)">
                                    <small *ngIf="identificationTypeField.errors?.required"
                                           id="identification-type-help-1"
                                           class="p-error">
                                        {{messageService.fieldRequired}}
                                    </small>
                                </div>
                            </div>
                            <div class="p-field p-xl-6 p-lg-6 p-md-6 p-sm-12">
                                <label for="identification">
                                    <i class="p-error">*</i> Número de documento:
                                    <i *ngIf="identificationField.valid" class="pi pi-check-circle icon-valid"></i>
                                    <i *ngIf="identificationField.invalid && (identificationField.touched || identificationField.dirty)"
                                       class="pi pi-times-circle icon-invalid"></i>
                                </label>
                                <input id="identification" formControlName="identification" pInputText>
                                <div *ngIf="identificationField.invalid && (identificationField.touched || identificationField.dirty)">
                                    <small *ngIf="identificationField.errors?.required" id="identification-help-1"
                                           class="p-error">
                                        {{messageService.fieldRequired}}
                                    </small>
                                    <small *ngIf="identificationField.errors?.minlength" id="identification-help-2"
                                           class="p-error">
                                        {{messageService.fieldMinLength(identificationField)}}
                                    </small>
                                    <small *ngIf="identificationField.errors?.maxlength" id="identification-help-3"
                                           class="p-error">
                                        {{messageService.fieldMaxLength(identificationField)}}
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="p-formgrid p-grid">
                            <div class="p-field p-xl-4 p-lg-4 p-md-4 p-sm-12">
                                <label for="email">
                                    <i class="p-error">*</i> Correo electrónico:
                                    <i *ngIf="emailField.valid" class="pi pi-check-circle icon-valid"></i>
                                    <i *ngIf="emailField.invalid && (emailField.touched || emailField.dirty)"
                                       class="pi pi-times-circle icon-invalid"></i>
                                </label>
                                <input pInputText id="email" formControlName="email"
                                       placeholder="Ej. ejemplo@ejemplo.com">
                                <div *ngIf="emailField.invalid && (emailField.touched || emailField.dirty)">
                                    <small *ngIf="emailField.errors?.required" id="email-help-1" class="p-error">
                                        {{messageService.fieldRequired}}
                                    </small>
                                    <small *ngIf="emailField.errors?.email" id="email-help-2" class="p-error">
                                        {{messageService.fieldEmail}}
                                    </small>
                                    <small *ngIf="emailField.errors?.maxlength" id="email-help-3" class="p-error">
                                        {{messageService.fieldMaxLength(emailField)}}
                                    </small>
                                </div>
                            </div>
                            <div class="p-field p-xl-4 p-lg-4 p-md-4 p-sm-12">
                                <label for="phone">
                                    <i class="p-error">*</i> Telefóno convencional:
                                    <i *ngIf="phoneField.valid" class="pi pi-check-circle icon-valid"></i>
                                    <i *ngIf="phoneField.invalid && (phoneField.touched || phoneField.dirty)"
                                       class="pi pi-times-circle icon-invalid"></i>
                                </label>
                                <p-inputMask id="phone" mask="(09)9999999" formControlName="phone"></p-inputMask>
                                <div *ngIf="phoneField.invalid && (phoneField.touched || phoneField.dirty)">
                                    <small *ngIf="phoneField.errors?.required" id="phone-help-1" class="p-error">
                                        {{messageService.fieldRequired}}
                                    </small>
                                </div>
                            </div>
                            <div class="p-field p-xl-4 p-lg-4 p-md-4 p-sm-12">
                                <label for="cellphone">
                                    <i class="p-error">*</i> Telefóno celular:
                                    <i *ngIf="cellphoneField.valid" class="pi pi-check-circle icon-valid"></i>
                                    <i *ngIf="cellphoneField.invalid && (cellphoneField.touched || cellphoneField.dirty)"
                                       class="pi pi-times-circle icon-invalid"></i>
                                </label>
                                <p-inputMask id="cellphone" mask="0999999999"
                                             formControlName="cellphone"></p-inputMask>
                                <div *ngIf="cellphoneField.invalid && (cellphoneField.touched || cellphoneField.dirty)">
                                    <small *ngIf="cellphoneField.errors?.required" id="cellphone-help-1"
                                           class="p-error">
                                        {{messageService.fieldRequired}}
                                    </small>
                                </div>
                            </div>
                        </div>
                    </p-card>
                    <br>
                    <p-card header="Ubicación:">
                        <div class="p-field">
                            <app-location-address id="address"
                                                  formControlName="address"
                                                  [option]="3"
                                                  (formAddressOut)="formAddress=$event"
                                                  (formLocationOut)="setFormLocation($event)">
                            </app-location-address>
                        </div>
                    </p-card>
                </div>
            </div>
            <div class="p-field p-xl-6 p-lg-6 p-md-12 p-sm-12">
                <p-card header="Información Adicional:">
                    <div class="p-formgrid p-grid">
                        <div class="p-field p-xl-6 p-lg-6 p-md-6 p-sm-12">
                            <label for="trade_name">
                                <i class="p-error">*</i> Nombre comercial:
                                <i *ngIf="tradeNameField.valid" class="pi pi-check-circle icon-valid"></i>
                                <i *ngIf="tradeNameField.invalid && (tradeNameField.touched || tradeNameField.dirty)"
                                   class="pi pi-times-circle icon-invalid"></i>
                            </label>
                            <input id="trade_name" formControlName="trade_name" pInputText>
                            <div *ngIf="tradeNameField.invalid && (tradeNameField.touched ||tradeNameField.dirty)">
                                <small *ngIf="tradeNameField.errors?.required" id="tradeName-help-1"
                                       class="p-error">
                                    {{messageService.fieldRequired}}
                                </small>
                            </div>
                        </div>
                        <div class="p-field p-xl-6 p-lg-6 p-md-6 p-sm-12">
                            <label for="prefix">
                                <i class="p-error">*</i>Prefijo:
                                <i *ngIf="prefixField.valid" class="pi pi-check-circle icon-valid"></i>
                                <i *ngIf="prefixField.invalid && (prefixField.touched || prefixField.dirty)"
                                   class="pi pi-times-circle icon-invalid"></i>
                            </label>
                            <input id="prefix" formControlName="prefix" pInputText>
                            <div *ngIf="prefixField.invalid && (prefixField.touched ||prefixField.dirty)">
                                <small *ngIf="prefixField.errors?.required" id="prefix-help-1" class="p-error">
                                    {{messageService.fieldRequired}}
                                </small>
                                <small *ngIf="prefixField.errors?.minlength" id="prefix-help-2" class="p-error">
                                    {{messageService.fieldMinLength(prefixField)}}
                                </small>
                                <small *ngIf="prefixField.errors?.maxlength" id="prefix-help-3" class="p-error">
                                    {{messageService.fieldMaxLength(prefixField)}}
                                </small>
                            </div>
                        </div>
                    </div>
                    <div class="p-formgrid p-grid">
                        <div class="p-field p-xl-6 p-lg-6 p-md-6 p-sm-12">
                            <label for="web">
                                <i class="p-error">*</i> Página web:
                                <i *ngIf="webField.valid" class="pi pi-check-circle icon-valid"></i>
                                <i *ngIf="webField.invalid && (webField.touched || webField.dirty)"
                                   class="pi pi-times-circle icon-invalid"></i>
                            </label>
                            <input pInputText id="web" formControlName="web" placeholder="mi-dominio.com">
                            <div *ngIf="webField.invalid && (webField.touched || webField.dirty)">
                                <small *ngIf="webField.errors?.required" id="web-help-1" class="p-error">
                                    {{messageService.fieldRequired}}
                                </small>
                                <small *ngIf="webField.errors?.maxlength" id="web-help-2" class="p-error">
                                    {{messageService.fieldMaxLength(webField)}}
                                </small>
                                <small *ngIf="webField.errors?.isWeb" id="web-help-3" class="p-error">
                                    {{messageService.fieldWeb}}
                                </small>
                            </div>
                        </div>
                        <div class="p-field p-xl-6 p-lg-6 p-md-6 p-sm-12">
                            <label for="type">
                                <i class="p-error">*</i> Tipo de empresa:
                                <i *ngIf="typeField.valid" class="pi pi-check-circle icon-valid"></i>
                                <i *ngIf="typeField.invalid && (typeField.touched || typeField.dirty)"
                                   class="pi pi-times-circle icon-invalid"></i>
                            </label>
                            <p-dropdown id="type" [options]="types" formControlName="type" optionLabel="name"
                                        [filter]="true"
                                        filterBy="name" placeholder="Seleccione...">
                                <ng-template pTemplate="selectedItem">
                                    <div class="country-item country-item-value" *ngIf="typeField.value">
                                        <div>{{typeField.value.name}}</div>
                                    </div>
                                </ng-template>
                                <ng-template let-item pTemplate="item">
                                    <div class="country-item">
                                        <div>{{item.name}}</div>
                                    </div>
                                </ng-template>
                            </p-dropdown>
                        </div>
                    </div>
                    <div class="p-formgrid p-grid">
                        <div class="p-field p-xl-6 p-lg-6 p-md-6 p-sm-12">
                            <label for="person_type">
                                <i class="p-error">*</i> Persona:
                                <i *ngIf="personTypeField.valid" class="pi pi-check-circle icon-valid"></i>
                                <i *ngIf="personTypeField.invalid && (personTypeField.touched || personTypeField.dirty)"
                                   class="pi pi-times-circle icon-invalid"></i>
                            </label>
                            <p-dropdown id="person_type" [options]="personType" formControlName="person_type"
                                        optionLabel="name"
                                        [filter]="true" filterBy="name" placeholder="Seleccione...">
                                <ng-template pTemplate="selectedItem">
                                    <div class="country-item country-item-value" *ngIf="personTypeField.value">
                                        <div>{{personTypeField.value.name}}</div>
                                    </div>
                                </ng-template>
                                <ng-template let-item pTemplate="item">
                                    <div class="country-item">
                                        <div>{{item.name}}</div>
                                    </div>
                                </ng-template>
                            </p-dropdown>
                        </div>
                        <div class="p-field p-xl-6 p-lg-6 p-md-6 p-sm-12">
                            <label for="activity_type">
                                <i class="p-error">*</i> Tipo de Actividad:
                                <i *ngIf="activityTypesField.valid" class="pi pi-check-circle icon-valid"></i>
                                <i *ngIf="activityTypesField.invalid && (activityTypesField.touched || activityTypesField.dirty)"
                                   class="pi pi-times-circle icon-invalid"></i>
                            </label>
                            <p-dropdown id="activity_type" [options]="activityTypes" formControlName="activity_type"
                                        optionLabel="name" [filter]="true" filterBy="name"
                                        placeholder="Seleccione...">
                                <ng-template pTemplate="selectedItem">
                                    <div class="country-item country-item-value" *ngIf="activityTypesField.value">
                                        <div>{{activityTypesField.value.name}}</div>
                                    </div>
                                </ng-template>
                                <ng-template let-item pTemplate="item">
                                    <div class="country-item">
                                        <div>{{item.name}}</div>
                                    </div>
                                </ng-template>
                            </p-dropdown>
                        </div>
                    </div>
                    <div class="p-fluid p-formgrid p-grid">
                        <div class="p-field p-xl-6 p-lg-6 p-md-12 p-sm-12">
                            <button pButton pRipple type="button" (click)="addComercialActivity()" iconPos="right"
                                    icon="pi pi-plus"
                                    class="p-button-success p-button-raised"
                                    label="Añadir Actividades Comerciales"></button>
                        </div>
                    </div>
                    <div formArrayName="comercial_activities">
                        <div *ngFor="let comercial_activity of comercialActivitiesField.controls let i = index;">
                            <div class="p-fluid p-formgrid p-grid">
                                <div class="p-field p-xl-11 p-lg-11 p-md-11 p-sm-12">
                                    <input [formControlName]="i" pInputText>
                                </div>
                                <div class="p-field p-xl-1 p-lg-1 p-md-1 p-sm-12">
                                    <button pButton pRipple type="button" (click)="removeComercialActivity(i)"
                                            iconPos="right"
                                            icon="pi pi-trash" class="p-button-danger p-button-rounded"></button>
                                </div>
                            </div>
                            <div class="p-fluid p-formgrid p-grid">
                                <div class="p-field p-xl-12 p-lg-12 p-md-12 p-sm-12">
                                    <div *ngIf="comercialActivitiesField.invalid
                                                && (comercialActivitiesField.touched || comercialActivitiesField.dirty)">
                                        <small *ngIf="comercialActivitiesField.controls[i].errors?.required"
                                               id="comercial-activities-help-1"
                                               class="p-error">
                                            {{messageService.fieldRequired}}
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-card>
            </div>
        </div>
        <div class="p-formgrid p-grid">
            <div class="p-field p-xl-2 p-lg-2 p-md-12 p-sm-12">
                <button pButton pRipple type="submit" label="Guardar" icon="pi pi-save"
                        class="p-button-raised"></button>
            </div>
        </div>
    </form>
</div>
